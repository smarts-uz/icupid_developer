// flash detection
var flash=new Object();flash.installed=false;flash.version='0.0';if(navigator.plugins&&navigator.plugins.length){for(x=0;x<navigator.plugins.length;x++){if(navigator.plugins[x].name.indexOf('Shockwave Flash')!=-1){flash.version=navigator.plugins[x].description.split('Shockwave Flash ')[1];flash.installed=true;break}}}else if(window.ActiveXObject){for(x=2;x<=13;x++){try{oFlash=eval("new ActiveXObject('ShockwaveFlash.ShockwaveFlash."+x+"');");if(oFlash){flash.installed=true;flash.version=x+'.0'}}catch(e){}}}flash.ver=Array();for(i=4;i<=13;i++){eval("flash.ver["+i+"]=(flash.installed&&parseInt(flash.version)>="+i+")?true:false;")}

function popup(name, url, width, height, toolbar, menubar, statusbar, scrollbar, resizable){
	var wint = (screen.height - height) / 2;
	var winl = (screen.width - width) / 2;
	toolbar_str = toolbar ? 'yes' : 'no';
	menubar_str = menubar ? 'yes' : 'no';
	statusbar_str = statusbar ? 'yes' : 'no';
	scrollbar_str = scrollbar ? 'yes' : 'no';
	resizable_str = resizable ? 'yes' : 'no';
	var x = window.open(url, name, 'left='+winl+',top='+wint+',width='+width+',height='+height+',toolbar='+toolbar_str+',menubar='+menubar_str+',status='+statusbar_str+',scrollbars='+scrollbar_str+',resizable='+resizable_str);
	if( x.focus ) { x.focus(); }
	return false;
}
function urlencode(ch) {
//	ch = ch.replace(/[ ]/g,""); return escape(ch)
	return ch.match(/\w+/i);
}
function loadChart(name, movie, data, width, height) {
	if(flash.installed && flash.ver[6]) {
		var wsize = width + 24;
		var hsize = height + 120;
		var xpopup = window.open('', urlencode(name), 'left='+((screen.width - wsize) / 2)+',top='+((screen.height - hsize) / 2)+',width='+wsize+',height='+hsize+',toolbar=no,menubar=no,status=yes,scrollbars=no,resizable=no');
		var xchild = xpopup.document;
		xchild.write('<html><head><title>Flash Charts Pro® 4 &gt; '+name+'</title>');
		xchild.write('<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">');
		xchild.write('<link rel="stylesheet" href="css/popups.css">');
		xchild.write("<script language=\"javascript\" type=\"text/javascript\">if(typeof deconcept==\"undefined\")var deconcept=new Object();if(typeof deconcept.util==\"undefined\")deconcept.util=new Object();if(typeof deconcept.SWFObjectUtil==\"undefined\")deconcept.SWFObjectUtil=new Object();deconcept.SWFObject=function(swf,id,w,h,ver,c,useExpressInstall,quality,xiRedirectUrl,redirectUrl,detectKey){if(!document.getElementById){return}this.DETECT_KEY=detectKey?detectKey:'detectflash';this.skipDetect=deconcept.util.getRequestParameter(this.DETECT_KEY);this.params=new Object();this.variables=new Object();this.attributes=new Array();if(swf){this.setAttribute('swf',swf)}if(id){this.setAttribute('id',id)}if(w){this.setAttribute('width',w)}if(h){this.setAttribute('height',h)}if(ver){this.setAttribute('version',new deconcept.PlayerVersion(ver.toString().split(\".\")))}this.installedVer=deconcept.SWFObjectUtil.getPlayerVersion();if(c){this.addParam('bgcolor',c)}var q=quality?quality:'high';this.addParam('quality',q);this.setAttribute('useExpressInstall',useExpressInstall);this.setAttribute('doExpressInstall',false);var xir=(xiRedirectUrl)?xiRedirectUrl:window.location;this.setAttribute('xiRedirectUrl',xir);this.setAttribute('redirectUrl','');if(redirectUrl){this.setAttribute('redirectUrl',redirectUrl)}};deconcept.SWFObject.prototype={setAttribute:function(name,value){this.attributes[name]=value},getAttribute:function(name){return this.attributes[name]},addParam:function(name,value){this.params[name]=value},getParams:function(){return this.params},addVariable:function(name,value){this.variables[name]=value},getVariable:function(name){return this.variables[name]},getVariables:function(){return this.variables},getVariablePairs:function(){var variablePairs=new Array();var key;var variables=this.getVariables();for(key in variables){variablePairs.push(key+\"=\"+variables[key])}return variablePairs},getSWFHTML:function(){var swfNode=\"\";if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){if(this.getAttribute(\"doExpressInstall\")){this.addVariable(\"MMplayerType\",\"PlugIn\")}swfNode='<embed type=\"application/x-shockwave-flash\" src=\"'+this.getAttribute('swf')+'\" width=\"'+this.getAttribute('width')+'\" height=\"'+this.getAttribute('height')+'\"';swfNode+=' id=\"'+this.getAttribute('id')+'\" name=\"'+this.getAttribute('id')+'\" ';var params=this.getParams();for(var key in params){swfNode+=[key]+'=\"'+params[key]+'\" '}var pairs=this.getVariablePairs().join(\"&\");if(pairs.length>0){swfNode+='flashvars=\"'+pairs+'\"'}swfNode+='/>'}else{if(this.getAttribute(\"doExpressInstall\")){this.addVariable(\"MMplayerType\",\"ActiveX\")}swfNode='<object id=\"'+this.getAttribute('id')+'\" classid=\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\" width=\"'+this.getAttribute('width')+'\" height=\"'+this.getAttribute('height')+'\">';swfNode+='<param name=\"movie\" value=\"'+this.getAttribute('swf')+'\"/>';var params=this.getParams();for(var key in params){swfNode+='<param name=\"'+key+'\" value=\"'+params[key]+'\"/>'}var pairs=this.getVariablePairs().join(\"&\");if(pairs.length>0){swfNode+='<param name=\"flashvars\" value=\"'+pairs+'\"/>'}swfNode+=\"</object>\"}return swfNode},write:function(elementId){if(this.getAttribute('useExpressInstall')){var expressInstallReqVer=new deconcept.PlayerVersion([6,0,65]);if(this.installedVer.versionIsValid(expressInstallReqVer)&&!this.installedVer.versionIsValid(this.getAttribute('version'))){this.setAttribute('doExpressInstall',true);this.addVariable(\"MMredirectURL\",escape(this.getAttribute('xiRedirectUrl')));document.title=document.title.slice(0,47)+\"-Flash Player Installation\";this.addVariable(\"MMdoctitle\",document.title)}}if(this.skipDetect||this.getAttribute('doExpressInstall')||this.installedVer.versionIsValid(this.getAttribute('version'))){var n=(typeof elementId=='string')?document.getElementById(elementId):elementId;n.innerHTML=this.getSWFHTML();return true}else{if(this.getAttribute('redirectUrl')!=\"\"){document.location.replace(this.getAttribute('redirectUrl'))}}return false}};deconcept.SWFObjectUtil.getPlayerVersion=function(){var PlayerVersion=new deconcept.PlayerVersion([0,0,0]);if(navigator.plugins&&navigator.mimeTypes.length){var x=navigator.plugins[\"Shockwave Flash\"];if(x&&x.description){PlayerVersion=new deconcept.PlayerVersion(x.description.replace(/([a-zA-Z]|\s)+/,\"\").replace(/(\s+r|\s+b[0-9]+)/,\".\").split(\".\"))}}else{try{var axo=new ActiveXObject(\"ShockwaveFlash.ShockwaveFlash.7\")}catch(e){try{var axo=new ActiveXObject(\"ShockwaveFlash.ShockwaveFlash.6\");PlayerVersion=new deconcept.PlayerVersion([6,0,21]);axo.AllowScriptAccess=\"always\"}catch(e){if(PlayerVersion.major==6){return PlayerVersion}}try{axo=new ActiveXObject(\"ShockwaveFlash.ShockwaveFlash\")}catch(e){}}if(axo!=null){PlayerVersion=new deconcept.PlayerVersion(axo.GetVariable(\"$version\").split(\" \")[1].split(\",\"))}}return PlayerVersion};deconcept.PlayerVersion=function(arrVersion){this.major=arrVersion[0]!=null?parseInt(arrVersion[0]):0;this.minor=arrVersion[1]!=null?parseInt(arrVersion[1]):0;this.rev=arrVersion[2]!=null?parseInt(arrVersion[2]):0};deconcept.PlayerVersion.prototype.versionIsValid=function(fv){if(this.major<fv.major)return false;if(this.major>fv.major)return true;if(this.minor<fv.minor)return false;if(this.minor>fv.minor)return true;if(this.rev<fv.rev)return false;return true};deconcept.util={getRequestParameter:function(param){var q=document.location.search||document.location.hash;if(q){var pairs=q.substring(1).split(\"&\");for(var i=0;i<pairs.length;i++){if(pairs[i].substring(0,pairs[i].indexOf(\"=\"))==param){return pairs[i].substring((pairs[i].indexOf(\"=\")+1))}}}return \"\"}};deconcept.SWFObjectUtil.cleanupSWFs=function(){if(window.opera||!document.all)return;var objects=document.getElementsByTagName(\"OBJECT\");for(var i=0;i<objects.length;i++){objects[i].style.display='none';for(var x in objects[i]){if(typeof objects[i][x]=='function'){objects[i][x]=function(){}}}}};deconcept.SWFObjectUtil.prepUnload=function(){__flash_unloadHandler=function(){};__flash_savedUnloadHandler=function(){};if(typeof window.onunload=='function'){var oldUnload=window.onunload;window.onunload=function(){deconcept.SWFObjectUtil.cleanupSWFs();oldUnload()}}else{window.onunload=deconcept.SWFObjectUtil.cleanupSWFs}};if(typeof window.onbeforeunload=='function'){var oldBeforeUnload=window.onbeforeunload;window.onbeforeunload=function(){deconcept.SWFObjectUtil.prepUnload();oldBeforeUnload()}}else{window.onbeforeunload=deconcept.SWFObjectUtil.prepUnload};if(Array.prototype.push==null){Array.prototype.push=function(item){this[this.length]=item;return this.length}}var getQueryParamValue=deconcept.util.getRequestParameter;var FlashObject=deconcept.SWFObject;var SWFObject=deconcept.SWFObject;<\/script>");
		xchild.write('</head><body><h1>'+name+'</h1><div id="chart" class="chart">');
		xchild.write('This text is replaced by the Flash movie. Please, turn off any of your script blocker.');
		xchild.write('</div><form name="xmlview" action="" method="get" target="_blank"><input type="button" name="button" class="button" value="View XML Data" onClick="window.open(\'demo/data/'+data+'\',\'xmldata\',\'left=0,top=0,width=550px,height=350px,toolbar=yes,menubar=yes,status=yes,scrollbars=yes,resizable=yes\')"></form>');
		xchild.write("<script type=\"text/javascript\">var source = new SWFObject('demo/swf/"+movie+"', 'flashchart', '"+width+"', '"+height+"', 5, \"#ffffff\");source.addVariable(\"xml_file\", 'demo/data/"+data+"');source.write(\"chart\");<\/script>");
		xchild.write('</body></html>');
		xchild.close();
		if(xchild.focus) { xchild.focus(); }
	} else {
		alert('Flash 6.0 or newer are required to view our demo chart "'+name+'"! \nPlease visit macromedia website to download: http://www.adobe.com/software/flashplayer/');
	}
}